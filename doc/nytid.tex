\documentclass[a4paper,oneside]{book}
\newenvironment{abstract}{}{}
\usepackage{abstract}
\usepackage{noweb}
% Needed to relax penalty for breaking code chunks across pages, otherwise 
% there might be a lot of space following a code chunk.
\def\nwendcode{\endtrivlist \endgroup}
\let\nwdocspar=\smallbreak

\usepackage[hyphens]{url}
\usepackage{hyperref}
\usepackage{authblk}

\input{preamble.tex}

\title{%
  A schedule management tool for teaching
}
\author{%
  Daniel Bosk
}
\affil{%
  KTH EECS\\
  \texttt{dbosk@kth.se}
}

\begin{document}
\frontmatter
\maketitle

\vspace*{\fill}
\VerbatimInput{../LICENSE}
\clearpage

\begin{abstract}
  \input{abstract.tex}
\end{abstract}
\clearpage

\tableofcontents
\clearpage

\mainmatter
\chapter{Introduction}

We want to turn the TimeEdit schedule into a sign-up sheet in Google Sheets 
that our TAs can use to sign up for teaching slots.
\begin{minted}{python}
import nytid.schedules.utils as utils

COURSES = {
  "DD1310": 
  "https://cloud.timeedit.net/kth/web/public01/ri.ics?sid=7&p=0.w%2C12.n&objects=453080.10&e=220609&enol=t&ku=29&k=1B9F3AD696BCA5C434C68950EFD376DD",
  "DD1317": 
  "https://cloud.timeedit.net/kth/web/public01/ri.ics?sid=7&p=0.w%2C12.n&objects=455995.10&e=220609&enol=t&ku=29&k=BA4400E3C003685549BC65AD9EAD3DC58E"
}

for course, url in COURSES.items():
  utils.generate_signup_sheet(course, url)
\end{minted}

Now we have two CSV files, `DD1310.csv` and `DD1317.csv`, in the current 
working directory that we can upload to Google Sheets. Once uploaded, we can 
use the share URL with the following functions.
\begin{minted}{python}
import nytid.schedules.utils as utils

dd1317 = utils.read_signup_sheet_from_url(utils.google_sheet_to_csv_url("https://docs.google.com/spreadsheets/d/the-share-url"))

dd1310 = utils.read_signup_sheet_from_url(utils.google_sheet_to_csv_url("https://docs.google.com/spreadsheets/d/the-share-url"))

ta_time_dd1310 = utils.hours_per_TA(dd1310)
amanuenses = utils.compute_amanuensis_data(dd1310+dd1317)
\end{minted}


\part{The library}

\input{../src/nytid/schedules/init.tex}
\input{../src/nytid/schedules/utils.tex}


%\part{A command-line interface}
%
%\input{../src/nytid/cli/init.tex}



\backmatter
\printbibliography


\end{document}
